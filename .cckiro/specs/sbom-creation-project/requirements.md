# SBOM作成プロジェクト - 要件定義書

## 1. プロジェクト概要

### 対象アプリケーション
- **名称**: Dedication (エンジニアポートフォリオサイト)
- **技術スタック**: Next.js 15 + TypeScript + Tailwind CSS
- **現在の状態**: 開発完了、デプロイ準備段階

### 目的
現在のアプリケーションに対して、最新のベストプラクティスに基づいたSBOM（Software Bill of Materials）を作成し、ソフトウェアサプライチェーンの透明性とセキュリティを確保する。

## 2. 機能要件

### 2.1 SBOM生成機能
- **FR-001**: package.jsonに基づいて全ての依存関係を抽出できること
- **FR-002**: 直接依存と間接依存（transitive dependencies）を区別して記録できること
- **FR-003**: 各コンポーネントのバージョン情報を正確に記録できること
- **FR-004**: ライセンス情報を自動的に収集・記録できること
- **FR-005**: 複数の標準フォーマット（SPDX、CycloneDX）で出力できること

### 2.2 セキュリティ機能
- **FR-006**: 既知の脆弱性を自動検出・報告できること
- **FR-007**: 脆弱性情報をSBOMと関連付けて管理できること
- **FR-008**: VEX（Vulnerability Exploitability eXchange）形式で脆弱性状況を記録できること
- **FR-009**: SBOMのデジタル署名による整合性検証ができること

### 2.3 自動化機能
- **FR-010**: CI/CDパイプライン（GitHub Actions）との統合ができること
- **FR-011**: 依存関係更新時の自動SBOM再生成ができること
- **FR-012**: 定期的な脆弱性スキャンと更新ができること

## 3. 非機能要件

### 3.1 パフォーマンス要件
- **NFR-001**: SBOM生成時間は5分以内であること
- **NFR-002**: 生成されるSBOMファイルサイズは10MB以内であること

### 3.2 可用性要件
- **NFR-003**: 24時間365日いつでもSBOM生成が実行可能であること
- **NFR-004**: 依存関係の変更から24時間以内にSBOMが更新されること

### 3.3 セキュリティ要件
- **NFR-005**: SBOM生成プロセスにおいて機密情報が漏洩しないこと
- **NFR-006**: 生成されたSBOMは改ざん検知可能であること
- **NFR-007**: アクセス制御により適切な権限管理が行われること

### 3.4 運用性要件
- **NFR-008**: 運用者が容易にSBOM生成状況を監視できること
- **NFR-009**: エラー発生時の適切なログ記録と通知が行われること
- **NFR-010**: SBOM形式の変換・マージ処理が可能であること

## 4. 技術要件

### 4.1 対応フォーマット
- **SPDX 2.3**: ISO/IEC認証済み国際標準フォーマット
- **CycloneDX 1.6**: OWASP推奨のセキュリティ特化フォーマット

### 4.2 対応ツール
- **Primary**: Syft（多言語・多フォーマット対応）
- **Secondary**: npm-sbom（Node.js特化）
- **Scanning**: Trivy（脆弱性検出）

### 4.3 統合要件
- **GitHub Actions**: 自動化ワークフロー
- **npm/Node.js**: パッケージ管理システム
- **Git**: バージョン管理システム

## 5. データ要件

### 5.1 記録対象データ
- **基本情報**: 作成者、作成日時、SBOM識別子
- **コンポーネント情報**: 名前、バージョン、パッケージマネージャー
- **ライセンス情報**: ライセンス種別、著作権情報
- **関係性情報**: 依存関係ツリー、親子関係
- **セキュリティ情報**: 脆弱性ID、重要度、対応状況

### 5.2 出力ファイル
- `sbom.spdx.json`: SPDX形式のSBOM
- `sbom.cyclonedx.json`: CycloneDX形式のSBOM
- `vulnerability-report.json`: 脆弱性レポート
- `sbom-verification.txt`: デジタル署名・検証情報

## 6. 制約条件

### 6.1 技術制約
- Node.js 18以上の環境でのみ動作
- インターネット接続が必要（脆弱性DB参照のため）
- GitHub Actions環境での実行を前提

### 6.2 運用制約
- 既存のCI/CDプロセスに影響を与えないこと
- 追加の外部サービス依存を最小限に抑えること
- 無料で利用可能なツール・サービスのみ使用

## 7. 受入基準

### 7.1 成功基準
- ✅ 全31個の依存関係が正確にSBOMに記録される
- ✅ SPDX、CycloneDX両形式でSBOMが生成される
- ✅ 既知の脆弱性がある場合、適切に検出・報告される
- ✅ GitHub Actionsでの自動実行が正常に動作する
- ✅ 生成されたSBOMがフォーマット仕様に準拠している

### 7.2 品質基準
- 生成時間が5分以内
- 脆弱性検出の偽陽性率が5%以下
- SBOMの完全性検証が100%成功

## 8. リスクと対策

### 8.1 技術リスク
- **リスク**: 脆弱性データベースの可用性
- **対策**: 複数の脆弱性DBを参照、キャッシュ機能

### 8.2 運用リスク
- **リスク**: CI/CDパイプラインの実行時間増加
- **対策**: 並列実行、キャッシュ活用

### 8.3 セキュリティリスク
- **リスク**: SBOM情報の不適切な公開
- **対策**: アクセス制御、機密情報のマスキング

## 9. スケジュール
- 要件承認: 即日
- 設計完了: 要件承認後1日以内
- 実装計画: 設計完了後1日以内
- 実装完了: 実装計画承認後2日以内

---

**注記**: この要件定義書は、spec-driven development手法に基づいて作成されており、次のフェーズ（設計）への入力となります。